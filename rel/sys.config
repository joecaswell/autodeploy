[
    {exec, [
        {verbose, true},
        {debug, 1}
        % {user, "autodeploy"},
        % {limit_users, "autodeploy", "zdsms"}
    ]},
    {autodeploy, [
        {apps, [
            % NB: proplist key must be a string matching
            % "repository object" name field returned by GH webhook
            {"zendesk-sms", [
                {full_name, "basho/zendesk-sms"},
                {clone_path, "/home/zdsms/zendesk-sms"},
                {monit_name, "zendesk-sms"},
                {env_secret_var, "SECRET_zendesk_sms"},
                {user, "zdsms"},
                {group, "zdsms"}
            ]}
            % ,
            % {"other-app", [
            %     {full_name, "basho/other-app"},
            %     {clone_path, "/home/otherapp/other-app"},
            %     {monit_name, "other-app"},
            %     {user, "otherapp"}
            % ]}
        ]},
        {monit, [
            {url, "http://localhost:2812/"}, % NB: ends in slash
            {user, "admin"},
            {pass, "admin"}
        ]},
        {git, "/usr/bin/git"},
        {tmp_dir, "/tmp"}
    ]},
    {lager, [
        {error_logger_hwm,100},
        {error_logger_redirect,true},
        {crash_log_date,"$D0"},
        {crash_log_size,10485760},
        {crash_log_msg_size,65536},
        {handlers, [
            {lager_console_backend, debug},
            {lager_file_backend,
                [{file, "/var/log/autodeploy/debug.log"},
                    {level,debug},
                    {size,10485760},
                    {date,"$D0"},
                    {count,5}]},
            {lager_file_backend,
                [{file, "/var/log/autodeploy/console.log"},
                    {level,info},
                    {size,10485760},
                    {date,"$D0"},
                    {count,5}]},
            {lager_file_backend,
                [{file, "/var/log/autodeploy/error.log"},
                    {level,error},
                    {size,10485760},
                    {date,"$D0"},
                    {count,5}]}]},
        {crash_log, "/var/log/autodeploy/crash.log"},
        {crash_log_count,5}
    ]}
].
